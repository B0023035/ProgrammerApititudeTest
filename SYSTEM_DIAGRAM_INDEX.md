# 📊 システム構成図 - 完全ガイド

システムの全体像を複数の視点から理解できるように、6つの詳細ドキュメントに分割しました。

---

## 🗺️ ナビゲーションガイド

### 📁 Part 1: モジュール構成
**ファイル**: [SYSTEM_DIAGRAM_01_MODULES.md](SYSTEM_DIAGRAM_01_MODULES.md)

**内容**:
- ✅ プロジェクト全体のディレクトリ構造
- ✅ アプリケーション層の階層化 (app/, config/, resources/)
- ✅ フロントエンドコンポーネント一覧 (Vue Components)
- ✅ バックエンドサービス層の分割
- ✅ ルーティング・テスト・Docker設定

**活用場面**:
- 「このファイルはどこにあるの?」という質問
- 新規開発者のオンボーディング
- アーキテクチャ学習の最初の一歩

---

### 🌐 Part 2: インフラストラクチャ構成
**ファイル**: [SYSTEM_DIAGRAM_02_INFRASTRUCTURE.md](SYSTEM_DIAGRAM_02_INFRASTRUCTURE.md)

**内容**:
- ✅ 全体システムアーキテクチャ (7層構造)
- ✅ クライアント層 → ネットワーク層 → アプリケーション層 → DB層 → キャッシング層
- ✅ Docker コンテナ構成 (8つのサービス)
- ✅ Nginx リバースプロキシ
- ✅ Redis・MySQL・その他ミドルウェア

**活用場面**:
- 経営層・ステークホルダーへのシステム説明
- インフラストラクチャ改善の検討
- Docker セットアップの理解

---

### 🔄 Part 3: データフロー
**ファイル**: [SYSTEM_DIAGRAM_03_DATAFLOW.md](SYSTEM_DIAGRAM_03_DATAFLOW.md)

**内容**:
- ✅ ユーザーログインフロー (6段階)
- ✅ 試験実施フロー (セッション開始 → 問題表示 → 解答提出)
- ✅ 詳細なリクエスト/レスポンスフロー
- ✅ ミドルウェア処理の順序
- ✅ キャッシング戦略

**活用場面**:
- 機能実装時のロジック確認
- デバッグ時の処理フロー追跡
- パフォーマンス最適化の検討
- テストケース設計

---

### 📈 Part 4: 成績計算・セキュリティ
**ファイル**: [SYSTEM_DIAGRAM_04_SCORING_SECURITY.md](SYSTEM_DIAGRAM_04_SCORING_SECURITY.md)

**内容**:
- ✅ 成績計算フロー (8ステップ詳細)
- ✅ 素点 → 調整スコア → 最終スコア計算
- ✅ 不正検知統合
- ✅ 7層多層防御セキュリティアーキテクチャ
- ✅ CSRF対策・SQLインジェクション対策・認証・権限制御

**活用場面**:
- セキュリティレビュー
- スコアリングロジック実装
- 不正検知アルゴリズム調整
- コンプライアンス要件の確認

---

### 💾 Part 5: DB スキーマ・API仕様
**ファイル**: [SYSTEM_DIAGRAM_05_DB_API.md](SYSTEM_DIAGRAM_05_DB_API.md)

**内容**:
- ✅ 12個のテーブル関連図
- ✅ 認証・ユーザー管理テーブル
- ✅ 試験・問題・解答テーブル
- ✅ 不正監視・監査ログテーブル
- ✅ ユーザーAPI (登録・ログイン・ログアウト)
- ✅ 試験API (開始・問題取得・解答提出・試験提出)

**活用場面**:
- DB設計・正規化の確認
- API実装時のリクエスト/レスポンス仕様確認
- フロントエンド開発時の API 仕様確認
- Postman・Swagger ドキュメント作成

---

### 🔧 Part 6: 管理者API・デプロイメント
**ファイル**: [SYSTEM_DIAGRAM_06_ADMIN_DEPLOYMENT.md](SYSTEM_DIAGRAM_06_ADMIN_DEPLOYMENT.md)

**内容**:
- ✅ 管理者ユーザー管理API
- ✅ イベント・試験管理API
- ✅ 成績レポート・不正行為調査API
- ✅ Docker Compose 本格構成図
- ✅ 本番環境デプロイメント戦略
- ✅ CI/CD パイプライン

**活用場面**:
- 管理画面開発時の API 仕様確認
- 本番環境構築の検討
- インフラストラクチャ スケーリング計画
- デプロイメント自動化の検討

---

## 🎯 クイックスタート

### 🔍 「〇〇について知りたい!」→ どのファイルを見る?

| 質問 | 参照ファイル |
|------|----------|
| ディレクトリ構造は? | Part 1 (モジュール構成) |
| 全体のシステム構成は? | Part 2 (インフラ構成) |
| ユーザーがログインするまでの流れは? | Part 3 (データフロー) |
| セキュリティはどう実装されてる? | Part 4 (セキュリティ) |
| DBはどんなテーブル構成? | Part 5 (DB スキーマ) |
| APIの詳細仕様は? | Part 5 (API仕様) |
| 管理画面の機能は? | Part 6 (管理者API) |
| 本番環境にどう展開する? | Part 6 (デプロイメント) |
| 成績はどう計算される? | Part 4 (成績計算フロー) |
| 不正はどう検知される? | Part 4 (不正検知) |
| Docker コンテナは何が入ってる? | Part 2・Part 6 |

---

## 📐 図表化ツール

### Draw.io で図形化する手順

1. [Draw.io](https://draw.io) にアクセス
2. 新規作成 → 「URL or XML から開く」を選択
3. 各ファイルのテキスト形式の図をコピー & ペースト
4. 自動整形機能で図形化

### 推奨プラグイン

```bash
# VS Code Draw.io Integration
ext install hediet.vscode-drawio

# PlantUML (UML図生成)
ext install jebbs.plantuml
```

---

## 🔗 関連ドキュメント

| ドキュメント | 説明 |
|-----------|------|
| [ARCHITECTURE_00_INDEX.md](ARCHITECTURE_00_INDEX.md) | 別の視点からのアーキテクチャガイド |
| [ARCHITECTURE_01_BASIC_3LAYER.md](ARCHITECTURE_01_BASIC_3LAYER.md) | 基本3層構成の詳細 |
| [ARCHITECTURE_02_DETAILED_COMPONENTS.md](ARCHITECTURE_02_DETAILED_COMPONENTS.md) | 詳細コンポーネント仕様 |
| [ARCHITECTURE_03_USECASE_SEQUENCE.md](ARCHITECTURE_03_USECASE_SEQUENCE.md) | ユースケース・シーケンス図 |
| [API_ROUTES.md](API_ROUTES.md) | ルーティング詳細 |
| [MODEL_RELATIONSHIPS.md](MODEL_RELATIONSHIPS.md) | モデル関連図 |

---

## 💡 使用例

### 例1: 新入開発者向けオンボーディング

```
Day 1: Part 1 (モジュール構成) を読んで全体像を把握
       ↓
Day 2: Part 2 (インフラ構成) で Docker 環境を理解
       ↓
Day 3: Part 3 (データフロー) で実装ロジックを理解
       ↓
Day 4: Part 5 (DB・API) で DB スキーマ・API を確認
       ↓
実装開始!
```

### 例2: 試験実施機能の実装

```
1. Part 3 (データフロー) で全体フローを確認
   → 試験開始 → 問題取得 → 解答提出 → 成績計算
   
2. Part 5 (API仕様) で API リクエスト/レスポンスを確認
   
3. Part 5 (DB スキーマ) で必要なテーブル・リレーション確認
   
4. Part 4 (不正検知) で チェックロジック実装
   
5. Part 3 (データフロー) で 各エラーハンドリング確認
   
実装完了!
```

### 例3: セキュリティレビュー

```
1. Part 4 (セキュリティアーキテクチャ) で 7層防御を確認
   
2. Part 3 (データフロー) で CSRF・SQL injection チェック
   
3. Part 5 (API仕様) で 認証・権限制御を確認
   
4. Part 1 (モジュール構成) で middleware の配置確認
   
セキュリティレビュー完了!
```

---

## 📝 ドキュメント更新履歴

| 日付 | 更新内容 |
|------|---------|
| 2026-01-23 | ✅ 6部構成のシステム構成図を新規作成 |
| 2026-01-23 | ✅ インデックスドキュメント作成 |

---

## ❓ FAQ

### Q1: どのドキュメントから読み始めればいい?

**A**: 以下の順番をお勧めします:
1. **Part 1** (モジュール構成) - 5分で全体像を把握
2. **Part 2** (インフラ構成) - 10分でシステムレイアウトを理解
3. **Part 3** (データフロー) - 15分でロジック流れを理解

この3つで、システムの基礎的な理解が完成します。

---

### Q2: 図として見たい場合は?

**A**: 以下の方法があります:
1. **Draw.io**: テキストをコピペして自動図形化
2. **VS Code**: PlantUML 拡張機能で UML 化
3. **Mermaid**: マークダウンに埋め込み型図を挿入

各ファイルに ASCII アート形式の図が含まれているため、そのまま図として機能します。

---

### Q3: 実装中に「この処理はどうなってるの?」と疑問が出た場合

**A**: 
- **フロー疑問** → Part 3 (データフロー) を確認
- **DB構造疑問** → Part 5 (DB スキーマ) を確認
- **API仕様疑問** → Part 5 (API仕様) を確認
- **セキュリティ疑問** → Part 4 (セキュリティ) を確認
- **インフラ疑問** → Part 2 (インフラ構成) を確認

---

### Q4: 新しいAPI追加したら、どこに記録する?

**A**: 
1. 新しいエンドポイントを実装
2. Part 5 / Part 6 (API仕様セクション) に追記
3. Part 3 (データフロー) に処理フロー追記
4. 関連するドキュメント更新

---

## 🎓 学習ロードマップ

```
初心者向け:
├─ Part 1: モジュール構成 (5分)
├─ Part 2: インフラ構成 (10分)
└─ Part 3: データフロー - ログインフロー (15分)

中級者向け:
├─ Part 3: データフロー - 試験実施フロー (20分)
├─ Part 5: API仕様 (25分)
└─ Part 4: セキュリティ (30分)

上級者向け:
├─ Part 5: DB スキーマ - 詳細リレーション分析 (45分)
├─ Part 6: 管理者API (30分)
└─ Part 6: デプロイメント戦略 (45分)

マスター級:
├─ 全パートを通読して関連性を理解 (3時間)
├─ 各レイヤー間のデータフロー全体像を把握
└─ 本番環境構築・スケーリング検討
```

---

**🎉 すべてのシステム構成図がここに揃っています!**

各パートを参照して、システムの理解を深めてください。
