# 発表資料用解説 - 4. データベースの役割（簡単説明）

## 🗄️ データベースとは

```
【簡単な説明】
    「コンピューターの中の、情報を整理して
    保存しておく倉庫」

【例え】
    図書館の本棚のように、
    情報を系統立てて保存・管理している
```

---

## 📊 このシステムで保存される情報

### 1️⃣ **ユーザー情報**

```
┌─────────────────────────────────┐
│ users（ユーザー）テーブル        │
├─────────────────────────────────┤
│ 名前: 田中太郎                  │
│ メール: tanaka@example.com      │
│ パスワード: (暗号化)             │
│ 入学年度: 2020年                │
│ 登録日: 2024-01-01              │
│                                 │
│ 名前: 鈴木花子                  │
│ メール: suzuki@example.com      │
│ パスワード: (暗号化)             │
│ 入学年度: 2021年                │
│ 登録日: 2024-01-05              │
│                                 │
│ ... (ユーザー数分)               │
└─────────────────────────────────┘
```

**重要**: パスワードは **暗号化** される。
管理者でも元のパスワードは見れません。

---

### 2️⃣ **管理者情報**

```
┌─────────────────────────────────┐
│ admins（管理者）テーブル         │
├─────────────────────────────────┤
│ 名前: 山田太郎（教授）          │
│ メール: yamada@university.jp    │
│ パスワード: (暗号化)             │
│                                 │
│ 名前: 佐藤次郎（職員）          │
│ メール: sato@university.jp      │
│ パスワード: (暗号化)             │
│                                 │
│ ... (管理者数分)                 │
└─────────────────────────────────┘
```

---

### 3️⃣ **試験イベント情報**

```
┌──────────────────────────────────┐
│ events（イベント）テーブル        │
├──────────────────────────────────┤
│ イベントID: 1                   │
│ イベント名: 2024年1月 適性検査  │
│ セッションコード: EXAM202401    │
│ 開始日時: 2024-01-20 09:00     │
│ 終了日時: 2024-01-20 17:00     │
│ 試験時間: 120分                 │
│ 問題数: 各パート30問             │
│                                  │
│ イベントID: 2                   │
│ イベント名: 2024年2月 適性検査  │
│ セッションコード: EXAM202402    │
│ ...                              │
└──────────────────────────────────┘
```

---

### 4️⃣ **試験セッション情報**

```
┌────────────────────────────────────┐
│ exam_sessions（試験セッション）     │
│ 「ユーザーが試験を受けた記録」      │
├────────────────────────────────────┤
│ セッションID: 001                 │
│ ユーザー: 田中太郎               │
│ イベント: 2024年1月 適性検査     │
│ 開始時刻: 2024-01-20 09:15      │
│ 終了時刻: 2024-01-20 11:15      │
│ 成績: 75点                       │
│                                  │
│ セッションID: 002                 │
│ ユーザー: 鈴木花子               │
│ イベント: 2024年1月 適性検査     │
│ 開始時刻: 2024-01-20 09:20      │
│ 終了時刻: 2024-01-20 11:20      │
│ 成績: 82点                       │
│                                  │
│ セッションID: 003                 │
│ ユーザー: 高橋次郎               │
│ イベント: 2024年1月 適性検査     │
│ 開始時刻: 2024-01-20 09:25      │
│ 終了時刻: 2024-01-20 11:25      │
│ 成績: 68点                       │
│                                  │
│ ... (試験セッション数分)           │
└────────────────────────────────────┘
```

---

### 5️⃣ **問題情報**

```
┌────────────────────────────────────┐
│ questions（問題）テーブル           │
│ 「出題される問題」                 │
├────────────────────────────────────┤
│ 問題ID: 1                         │
│ イベント: 2024年1月 適性検査     │
│ Part: 1                           │
│ 問題番号: 1                       │
│ 問題文: 「次のコードを実行した    │
│         場合、出力はどうなる     │
│         でしょうか？」            │
│ 画像: (プログラミングコード)      │
│                                  │
│ 問題ID: 2                         │
│ イベント: 2024年1月 適性検査     │
│ Part: 1                           │
│ 問題番号: 2                       │
│ 問題文: 「...」                  │
│ 画像: (画像URL)                   │
│                                  │
│ ... (90問)                        │
└────────────────────────────────────┘
```

---

### 6️⃣ **選択肢情報**

```
┌────────────────────────────────────┐
│ choices（選択肢）テーブル          │
│ 「各問題の選択肢」                 │
├────────────────────────────────────┤
│ 問題ID: 1の選択肢                │
│ ├─ 選択肢A: 「コンパイルエラー」  │
│ ├─ 選択肢B: 「実行時エラー」      │
│ ├─ 選択肢C: 「正常に動作」 ✓正解 │
│ └─ 選択肢D: 「構文エラー」        │
│                                  │
│ 問題ID: 2の選択肢                │
│ ├─ 選択肢A: 「...」              │
│ ├─ 選択肢B: 「...」              │
│ ├─ 選択肢C: 「...」  ✓正解       │
│ └─ 選択肢D: 「...」              │
│                                  │
│ ... (問題ごと)                   │
└────────────────────────────────────┘
```

---

### 7️⃣ **ユーザーの解答情報**

```
┌────────────────────────────────────┐
│ answers（解答）テーブル             │
│ 「ユーザーがした回答」             │
├────────────────────────────────────┤
│ ユーザー: 田中太郎               │
│ 問題: 1                          │
│ ユーザーが選んだ: C  ← 「正解」 ✓ │
│ 回答日時: 2024-01-20 09:16      │
│                                  │
│ ユーザー: 田中太郎               │
│ 問題: 2                          │
│ ユーザーが選んだ: A  ← 「不正解」✗ │
│ 回答日時: 2024-01-20 09:17      │
│                                  │
│ ユーザー: 田中太郎               │
│ 問題: 3                          │
│ ユーザーが選んだ: C  ← 「正解」 ✓ │
│ 回答日時: 2024-01-20 09:18      │
│                                  │
│ ... (90問分のすべてのユーザーの回答) │
└────────────────────────────────────┘
```

---

### 8️⃣ **不正検知ログ**

```
┌────────────────────────────────────┐
│ exam_violations（不正検知）        │
│ 「試験中に検知された不正」          │
├────────────────────────────────────┤
│ ユーザー: 田中太郎               │
│ 試験セッション: 001              │
│ 不正の種類: ウィンドウフォーカス喪失
│ 検知時刻: 2024-01-20 09:30      │
│ 詳細: 別タブに切り替えた         │
│                                  │
│ ユーザー: 高橋次郎               │
│ 試験セッション: 003              │
│ 不正の種類: コピー試行           │
│ 検知時刻: 2024-01-20 09:45      │
│ 詳細: Ctrl+C キーボード検知      │
│                                  │
│ ... (検知された不正のみ)           │
└────────────────────────────────────┘
```

---

## 🔗 テーブル同士のつながり

```
┌──────────────┐
│ users        │  ← ユーザー情報
└────────┬─────┘
         │
    1ユーザー : 複数セッション
         │
         ▼
┌──────────────────┐
│ exam_sessions    │ ← 「このユーザーが
└────────┬─────────┘   この試験を受けた」
         │
    1セッション : 複数解答
         │
         ▼
┌────────────────┐
│ answers        │ ← 「この解答は正解/不正解」
└────────────────┘
         ▲
         │ 関連情報
         │
┌────────▼────────┐
│ questions       │ ← 「この問題」
└────────┬────────┘
         │
    1問題 : 複数選択肢
         │
         ▼
┌────────────────┐
│ choices        │ ← 「選択肢A, B, C, D」
└────────────────┘
```

---

## 📈 データベースの役割

### 役割1: 情報の保存

```
「ユーザーが登録したら、
 その情報を忘れないようにデータベースに保存する」

登録 → DB保存 → 何年後でも参照可能
```

---

### 役割2: 試験の問題と答えを管理

```
「管理者が登録した90問の問題と答えを
 整理して保存する」

管理者が登録 → DB保存 → ユーザーが試験を受ける
                ↓
               問題表示
```

---

### 役割3: 成績を計算・保存

```
「ユーザーの解答を記録して、
 自動的に成績を計算する」

ユーザー解答 → DB保存 → 自動採点
               ↓
           成績 = (正解数 / 90) × 100
```

---

### 役割4: 不正を記録する

```
「不正が検知されたら、
 記録しておいて管理者に報告」

不正検知 → DB保存 → 管理者が確認
          (記録)
```

---

## 💡 データベースなかったらどうなる？

```
【データベースがない場合】

❌ ユーザー登録 → 情報が保存されない
            → 次の日アクセスしたら
            → 「登録してください」

❌ 試験受験 → 解答が保存されない
          → 成績が記録されない
          → 結果が失われる

❌ 問題管理 → 毎日違う問題を入力するしかない
          → 問題が失われる

❌ 不正検知 → 記録されない
           → 管理者が対応できない
```

---

## 🔒 データベースのセキュリティ

### 重要な情報は暗号化

```
平文 (元の情報)
    ↓ 暗号化処理
暗号文 (意味不明な文字列)
    ↓ DB保存

例)
パスワード「password123」
    ↓ 暗号化
「$2y$10$j9h2kd9...」(長い暗号文)
```

**利点**:

- DB がハッキングされても
- パスワードは読めない

---

### 複数保護層

```
1️⃣ ファイアウォール
   「不正なアクセスをブロック」

2️⃣ ユーザー認証
   「ログイン情報で本人確認」

3️⃣ 権限管理
   「通常ユーザーは
    DB に直接アクセスできない」

4️⃣ データ暗号化
   「機密情報は暗号化」

5️⃣ バックアップ
   「定期的に複製を作成」
```

---

## 📊 まとめ表

| 役割             | 説明                               |
| ---------------- | ---------------------------------- |
| **情報保存**     | ユーザー登録、問題、成績を保存     |
| **データ管理**   | 膨大な情報を整理                   |
| **自動処理**     | 成績計算、不正検知                 |
| **検索**         | 「田中太郎の成績は？」と即座に検索 |
| **セキュリティ** | 情報を暗号化して保護               |
| **バックアップ** | 定期的に複製作成                   |

---

## ✨ 初心者向けまとめ

```
【データベースの役割】

🗄️ 大きな倉庫 (コンピューター内)

📦 保存されるもの
  ├─ ユーザー情報
  ├─ 問題と答え
  ├─ ユーザーの解答
  ├─ 成績
  └─ 不正ログ

🔒 安全対策
  ├─ 暗号化
  ├─ アクセス制限
  └─ バックアップ

💡 メリット
  ├─ 情報が失われない
  ├─ 素早く検索できる
  ├─ 自動で成績計算
  └─ 管理が簡単
```
